# frozen_string_literal: true

require "test_helper"

class WeatherKitAccountTest < Minitest::Test
  include ActiveSupport::Testing::TimeHelpers

  def test_weather_no_data
    WeatherKitAccount.stub :weather, {} do
      assert_equal({}, WeatherKitAccount.weather)
    end
  end

  def test_current_temperature_no_data
    WeatherKitAccount.stub :weather, {} do
      assert_nil(WeatherKitAccount.current_temperature)
    end
  end

  def test_current_temperature
    weather = {
      "currentWeather" =>
        {
          "temperature" => 30.06
        }
    }

    WeatherKitAccount.stub :weather, weather do
      assert_equal("86Â°", WeatherKitAccount.current_temperature)
    end
  end

  def test_health_no_data
    WeatherKitAccount.stub :last_fetched_at, nil do
      assert(!WeatherKitAccount.healthy?)
    end
  end

  def test_health_current_data
    WeatherKitAccount.stub :last_fetched_at, "2023-08-27 15:14:59 -0600" do
      travel_to DateTime.new(2023, 8, 27, 15, 16, 0, "-0600") do
        assert(WeatherKitAccount.healthy?)
      end
    end
  end

  def test_health_stale_data
    WeatherKitAccount.stub :last_fetched_at, "2023-08-27 15:14:59 -0600" do
      travel_to DateTime.new(2023, 8, 27, 16, 20, 0, "-0600") do
        refute(WeatherKitAccount.healthy?)
      end
    end
  end

  def test_hourly_calendar_events_no_data
    WeatherKitAccount.stub :weather, {} do
      assert_equal([], WeatherKitAccount.hourly_calendar_events)
    end
  end

  def test_calendar_events_example
    weather = {
      "forecastHourly" => {
        "hours" => [{"temperature" => 18.81,
                     "conditionCode" => "Clear",
                     "forecastStart" => "2023-08-27T05:00:00Z",
                     "precipitationType" => "snow"},
          {"temperature" => 18.11,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-08-27T06:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 17.66,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-08-27T07:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 16.81,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-08-27T08:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 16.11,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-08-27T09:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 15.5,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-08-27T10:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 14.99,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-08-27T11:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 14.32,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-08-27T12:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 15.35,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-08-27T13:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 17.41,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-08-27T14:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 19.69,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-08-27T15:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 22.68,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-08-27T16:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 25.12,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-08-27T17:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 27.37,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-08-27T18:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 29.13,
           "conditionCode" => "MostlyClear",
           "forecastStart" => "2023-08-27T19:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 30.08,
           "conditionCode" => "MostlyClear",
           "forecastStart" => "2023-08-27T20:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 29.73,
           "conditionCode" => "PartlyCloudy",
           "forecastStart" => "2023-08-27T21:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 28.31,
           "conditionCode" => "PartlyCloudy",
           "forecastStart" => "2023-08-27T22:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 27.6,
           "conditionCode" => "MostlyCloudy",
           "forecastStart" => "2023-08-27T23:00:00Z",
           "precipitationType" => "rain",
           "precipitationIntensity" => 0.6},
          {"temperature" => 25.65,
           "conditionCode" => "MostlyCloudy",
           "forecastStart" => "2023-08-28T00:00:00Z",
           "precipitationType" => "rain",
           "precipitationIntensity" => 1.0},
          {"temperature" => 23.74,
           "conditionCode" => "PartlyCloudy",
           "forecastStart" => "2023-08-28T01:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 22.43,
           "conditionCode" => "MostlyCloudy",
           "forecastStart" => "2023-08-28T02:00:00Z",
           "precipitationType" => "rain",
           "precipitationIntensity" => 0.3},
          {"temperature" => 20.73,
           "conditionCode" => "MostlyCloudy",
           "forecastStart" => "2023-08-28T03:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 20.26,
           "conditionCode" => "MostlyCloudy",
           "forecastStart" => "2023-08-28T04:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 19.5,
           "conditionCode" => "MostlyCloudy",
           "forecastStart" => "2023-08-28T05:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 18.91,
           "conditionCode" => "PartlyCloudy",
           "forecastStart" => "2023-08-28T06:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 18.13,
           "conditionCode" => "PartlyCloudy",
           "forecastStart" => "2023-08-28T07:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 16.87,
           "conditionCode" => "MostlyClear",
           "forecastStart" => "2023-08-28T08:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 16.27,
           "conditionCode" => "MostlyClear",
           "forecastStart" => "2023-08-28T09:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 15.74,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-08-28T10:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 15.39,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-08-28T11:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 15.1,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-08-28T12:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 15.47,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-08-28T13:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 16.91,
           "conditionCode" => "MostlyClear",
           "forecastStart" => "2023-08-28T14:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 18.92,
           "conditionCode" => "MostlyClear",
           "forecastStart" => "2023-08-28T15:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 20.22,
           "conditionCode" => "PartlyCloudy",
           "forecastStart" => "2023-08-28T16:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 21.92,
           "conditionCode" => "PartlyCloudy",
           "forecastStart" => "2023-08-28T17:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 23.64,
           "conditionCode" => "MostlyClear",
           "forecastStart" => "2023-08-28T18:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 25.04,
           "conditionCode" => "PartlyCloudy",
           "forecastStart" => "2023-08-28T19:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 24.65,
           "conditionCode" => "MostlyCloudy",
           "forecastStart" => "2023-08-28T20:00:00Z",
           "precipitationType" => "rain",
           "precipitationIntensity" => 0.3},
          {"temperature" => 23.98,
           "conditionCode" => "Drizzle",
           "forecastStart" => "2023-08-28T21:00:00Z",
           "precipitationType" => "rain",
           "precipitationIntensity" => 0.4},
          {"temperature" => 24.0,
           "conditionCode" => "Drizzle",
           "forecastStart" => "2023-08-28T22:00:00Z",
           "precipitationType" => "rain",
           "precipitationIntensity" => 1.0},
          {"temperature" => 22.74,
           "conditionCode" => "Drizzle",
           "forecastStart" => "2023-08-28T23:00:00Z",
           "precipitationType" => "rain",
           "precipitationIntensity" => 1.5},
          {"temperature" => 21.85,
           "conditionCode" => "Drizzle",
           "forecastStart" => "2023-08-29T00:00:00Z",
           "precipitationType" => "rain",
           "precipitationIntensity" => 1.1},
          {"temperature" => 21.21,
           "conditionCode" => "PartlyCloudy",
           "forecastStart" => "2023-08-29T01:00:00Z",
           "precipitationType" => "rain",
           "precipitationIntensity" => 0.3},
          {"temperature" => 20.22,
           "conditionCode" => "MostlyCloudy",
           "forecastStart" => "2023-08-29T02:00:00Z",
           "precipitationType" => "rain",
           "precipitationIntensity" => 0.3},
          {"temperature" => 19.14,
           "conditionCode" => "MostlyClear",
           "forecastStart" => "2023-08-29T03:00:00Z",
           "precipitationType" => "rain",
           "precipitationIntensity" => 0.3},
          {"temperature" => 18.33,
           "conditionCode" => "MostlyClear",
           "forecastStart" => "2023-08-29T04:00:00Z",
           "precipitationType" => "rain",
           "precipitationIntensity" => 0.4},
          {"temperature" => 17.55,
           "conditionCode" => "MostlyClear",
           "forecastStart" => "2023-08-29T05:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 17.03,
           "conditionCode" => "MostlyClear",
           "forecastStart" => "2023-08-29T06:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 16.45,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-08-29T07:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 15.66,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-08-29T08:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 15.05,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-08-29T09:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 14.44,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-08-29T10:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 13.91,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-08-29T11:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 13.53,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-08-29T12:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 14.1,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-08-29T13:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 15.68,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-08-29T14:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 17.89,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-08-29T15:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 20.06,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-08-29T16:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 22.03,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-08-29T17:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 23.72,
           "conditionCode" => "MostlyClear",
           "forecastStart" => "2023-08-29T18:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 25.42,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-08-29T19:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 26.7,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-08-29T20:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 27.66,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-08-29T21:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 28.27,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-08-29T22:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 28.45,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-08-29T23:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 27.79,
           "conditionCode" => "MostlyClear",
           "forecastStart" => "2023-08-30T00:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 26.46,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-08-30T01:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 24.31,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-08-30T02:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 22.81,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-08-30T03:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 21.4,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-08-30T04:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 20.19,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-08-30T05:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 19.23,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-08-30T06:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 18.4,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-08-30T07:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 17.41,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-08-30T08:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 16.71,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-08-30T09:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 15.8,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-08-30T10:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 14.99,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-08-30T11:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 14.2,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-08-30T12:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 14.95,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-08-30T13:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 16.81,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-08-30T14:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 19.98,
           "conditionCode" => "MostlyClear",
           "forecastStart" => "2023-08-30T15:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 23.32,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-08-30T16:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 26.88,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-08-30T17:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 29.81,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-08-30T18:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 31.97,
           "conditionCode" => "MostlyClear",
           "forecastStart" => "2023-08-30T19:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 33.4,
           "conditionCode" => "MostlyClear",
           "forecastStart" => "2023-08-30T20:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 34.28,
           "conditionCode" => "MostlyClear",
           "forecastStart" => "2023-08-30T21:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 34.65,
           "conditionCode" => "MostlyClear",
           "forecastStart" => "2023-08-30T22:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 34.21,
           "conditionCode" => "MostlyClear",
           "forecastStart" => "2023-08-30T23:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 32.83,
           "conditionCode" => "MostlyClear",
           "forecastStart" => "2023-08-31T00:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 30.81,
           "conditionCode" => "MostlyClear",
           "forecastStart" => "2023-08-31T01:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 28.22,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-08-31T02:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 25.95,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-08-31T03:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 24.23,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-08-31T04:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 22.8,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-08-31T05:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 21.77,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-08-31T06:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 20.6,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-08-31T07:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 19.53,
           "conditionCode" => "MostlyClear",
           "forecastStart" => "2023-08-31T08:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 18.67,
           "conditionCode" => "MostlyClear",
           "forecastStart" => "2023-08-31T09:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 17.68,
           "conditionCode" => "MostlyClear",
           "forecastStart" => "2023-08-31T10:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 16.75,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-08-31T11:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 16.51,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-08-31T12:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 17.72,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-08-31T13:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 19.71,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-08-31T14:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 22.07,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-08-31T15:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 24.83,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-08-31T16:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 28.03,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-08-31T17:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 30.93,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-08-31T18:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 32.56,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-08-31T19:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 33.72,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-08-31T20:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 34.45,
           "conditionCode" => "MostlyClear",
           "forecastStart" => "2023-08-31T21:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 34.79,
           "conditionCode" => "MostlyClear",
           "forecastStart" => "2023-08-31T22:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 34.24,
           "conditionCode" => "MostlyClear",
           "forecastStart" => "2023-08-31T23:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 32.9,
           "conditionCode" => "MostlyClear",
           "forecastStart" => "2023-09-01T00:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 30.49,
           "conditionCode" => "MostlyClear",
           "forecastStart" => "2023-09-01T01:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 27.59,
           "conditionCode" => "MostlyClear",
           "forecastStart" => "2023-09-01T02:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 25.02,
           "conditionCode" => "MostlyClear",
           "forecastStart" => "2023-09-01T03:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 23.45,
           "conditionCode" => "MostlyClear",
           "forecastStart" => "2023-09-01T04:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 22.17,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-09-01T05:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 20.81,
           "conditionCode" => "MostlyClear",
           "forecastStart" => "2023-09-01T06:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 19.55,
           "conditionCode" => "MostlyClear",
           "forecastStart" => "2023-09-01T07:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 18.61,
           "conditionCode" => "MostlyClear",
           "forecastStart" => "2023-09-01T08:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 18.1,
           "conditionCode" => "MostlyClear",
           "forecastStart" => "2023-09-01T09:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 17.39,
           "conditionCode" => "PartlyCloudy",
           "forecastStart" => "2023-09-01T10:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 16.55,
           "conditionCode" => "MostlyCloudy",
           "forecastStart" => "2023-09-01T11:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 17.22,
           "conditionCode" => "MostlyCloudy",
           "forecastStart" => "2023-09-01T12:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 18.33,
           "conditionCode" => "MostlyCloudy",
           "forecastStart" => "2023-09-01T13:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 19.72,
           "conditionCode" => "PartlyCloudy",
           "forecastStart" => "2023-09-01T14:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 21.72,
           "conditionCode" => "PartlyCloudy",
           "forecastStart" => "2023-09-01T15:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 24.99,
           "conditionCode" => "PartlyCloudy",
           "forecastStart" => "2023-09-01T16:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 27.91,
           "conditionCode" => "PartlyCloudy",
           "forecastStart" => "2023-09-01T17:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 30.2,
           "conditionCode" => "PartlyCloudy",
           "forecastStart" => "2023-09-01T18:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 31.57,
           "conditionCode" => "PartlyCloudy",
           "forecastStart" => "2023-09-01T19:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 32.34,
           "conditionCode" => "MostlyCloudy",
           "forecastStart" => "2023-09-01T20:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 31.9,
           "conditionCode" => "MostlyCloudy",
           "forecastStart" => "2023-09-01T21:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 30.13,
           "conditionCode" => "MostlyCloudy",
           "forecastStart" => "2023-09-01T22:00:00Z",
           "precipitationType" => "rain",
           "precipitationIntensity" => 0.2},
          {"temperature" => 27.87,
           "conditionCode" => "Cloudy",
           "forecastStart" => "2023-09-01T23:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 26.44,
           "conditionCode" => "Cloudy",
           "forecastStart" => "2023-09-02T00:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 24.68,
           "conditionCode" => "Cloudy",
           "forecastStart" => "2023-09-02T01:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 23.34,
           "conditionCode" => "MostlyCloudy",
           "forecastStart" => "2023-09-02T02:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 22.21,
           "conditionCode" => "MostlyCloudy",
           "forecastStart" => "2023-09-02T03:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 21.38,
           "conditionCode" => "MostlyCloudy",
           "forecastStart" => "2023-09-02T04:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 20.4,
           "conditionCode" => "MostlyCloudy",
           "forecastStart" => "2023-09-02T05:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 19.74,
           "conditionCode" => "PartlyCloudy",
           "forecastStart" => "2023-09-02T06:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 18.91,
           "conditionCode" => "PartlyCloudy",
           "forecastStart" => "2023-09-02T07:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 18.6,
           "conditionCode" => "PartlyCloudy",
           "forecastStart" => "2023-09-02T08:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 17.98,
           "conditionCode" => "PartlyCloudy",
           "forecastStart" => "2023-09-02T09:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 17.32,
           "conditionCode" => "PartlyCloudy",
           "forecastStart" => "2023-09-02T10:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 16.73,
           "conditionCode" => "PartlyCloudy",
           "forecastStart" => "2023-09-02T11:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 17.06,
           "conditionCode" => "PartlyCloudy",
           "forecastStart" => "2023-09-02T12:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 18.27,
           "conditionCode" => "PartlyCloudy",
           "forecastStart" => "2023-09-02T13:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 20.07,
           "conditionCode" => "PartlyCloudy",
           "forecastStart" => "2023-09-02T14:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 22.12,
           "conditionCode" => "PartlyCloudy",
           "forecastStart" => "2023-09-02T15:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 24.49,
           "conditionCode" => "PartlyCloudy",
           "forecastStart" => "2023-09-02T16:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 26.88,
           "conditionCode" => "PartlyCloudy",
           "forecastStart" => "2023-09-02T17:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 28.67,
           "conditionCode" => "PartlyCloudy",
           "forecastStart" => "2023-09-02T18:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 29.9,
           "conditionCode" => "PartlyCloudy",
           "forecastStart" => "2023-09-02T19:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 30.78,
           "conditionCode" => "PartlyCloudy",
           "forecastStart" => "2023-09-02T20:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 31.17,
           "conditionCode" => "PartlyCloudy",
           "forecastStart" => "2023-09-02T21:00:00Z",
           "precipitationType" => "rain",
           "precipitationIntensity" => 0.3},
          {"temperature" => 30.28,
           "conditionCode" => "PartlyCloudy",
           "forecastStart" => "2023-09-02T22:00:00Z",
           "precipitationType" => "rain",
           "precipitationIntensity" => 0.3},
          {"temperature" => 28.95,
           "conditionCode" => "MostlyCloudy",
           "forecastStart" => "2023-09-02T23:00:00Z",
           "precipitationType" => "rain",
           "precipitationIntensity" => 0.3},
          {"temperature" => 27.66,
           "conditionCode" => "Cloudy",
           "forecastStart" => "2023-09-03T00:00:00Z",
           "precipitationType" => "rain",
           "precipitationIntensity" => 0.3},
          {"temperature" => 26.92,
           "conditionCode" => "MostlyCloudy",
           "forecastStart" => "2023-09-03T01:00:00Z",
           "precipitationType" => "rain",
           "precipitationIntensity" => 0.3},
          {"temperature" => 25.27,
           "conditionCode" => "MostlyCloudy",
           "forecastStart" => "2023-09-03T02:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 23.97,
           "conditionCode" => "PartlyCloudy",
           "forecastStart" => "2023-09-03T03:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 22.8,
           "conditionCode" => "PartlyCloudy",
           "forecastStart" => "2023-09-03T04:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 21.46,
           "conditionCode" => "MostlyClear",
           "forecastStart" => "2023-09-03T05:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 20.53,
           "conditionCode" => "MostlyClear",
           "forecastStart" => "2023-09-03T06:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 19.53,
           "conditionCode" => "MostlyClear",
           "forecastStart" => "2023-09-03T07:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 18.72,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-09-03T08:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 17.94,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-09-03T09:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 17.09,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-09-03T10:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 16.32,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-09-03T11:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 16.67,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-09-03T12:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 16.85,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-09-03T13:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 19.05,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-09-03T14:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 21.47,
           "conditionCode" => "MostlyClear",
           "forecastStart" => "2023-09-03T15:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 24.09,
           "conditionCode" => "MostlyClear",
           "forecastStart" => "2023-09-03T16:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 26.69,
           "conditionCode" => "MostlyClear",
           "forecastStart" => "2023-09-03T17:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 28.56,
           "conditionCode" => "MostlyClear",
           "forecastStart" => "2023-09-03T18:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 29.73,
           "conditionCode" => "MostlyClear",
           "forecastStart" => "2023-09-03T19:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 30.48,
           "conditionCode" => "MostlyClear",
           "forecastStart" => "2023-09-03T20:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 30.85,
           "conditionCode" => "MostlyClear",
           "forecastStart" => "2023-09-03T21:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 30.4,
           "conditionCode" => "MostlyClear",
           "forecastStart" => "2023-09-03T22:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 29.59,
           "conditionCode" => "PartlyCloudy",
           "forecastStart" => "2023-09-03T23:00:00Z",
           "precipitationType" => "rain",
           "precipitationIntensity" => 0.2},
          {"temperature" => 28.68,
           "conditionCode" => "PartlyCloudy",
           "forecastStart" => "2023-09-04T00:00:00Z",
           "precipitationType" => "rain",
           "precipitationIntensity" => 0.3},
          {"temperature" => 27.79,
           "conditionCode" => "PartlyCloudy",
           "forecastStart" => "2023-09-04T01:00:00Z",
           "precipitationType" => "rain",
           "precipitationIntensity" => 0.2},
          {"temperature" => 25.83,
           "conditionCode" => "PartlyCloudy",
           "forecastStart" => "2023-09-04T02:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 24.09,
           "conditionCode" => "PartlyCloudy",
           "forecastStart" => "2023-09-04T03:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 22.53,
           "conditionCode" => "PartlyCloudy",
           "forecastStart" => "2023-09-04T04:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 21.16,
           "conditionCode" => "PartlyCloudy",
           "forecastStart" => "2023-09-04T05:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 20.04,
           "conditionCode" => "PartlyCloudy",
           "forecastStart" => "2023-09-04T06:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 18.88,
           "conditionCode" => "MostlyClear",
           "forecastStart" => "2023-09-04T07:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 17.9,
           "conditionCode" => "MostlyClear",
           "forecastStart" => "2023-09-04T08:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 17.0,
           "conditionCode" => "MostlyClear",
           "forecastStart" => "2023-09-04T09:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 16.15,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-09-04T10:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 15.56,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-09-04T11:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 15.99,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-09-04T12:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 17.47,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-09-04T13:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 19.78,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-09-04T14:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 22.39,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-09-04T15:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 25.2,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-09-04T16:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 27.92,
           "conditionCode" => "MostlyClear",
           "forecastStart" => "2023-09-04T17:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 29.8,
           "conditionCode" => "MostlyClear",
           "forecastStart" => "2023-09-04T18:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 30.92,
           "conditionCode" => "MostlyClear",
           "forecastStart" => "2023-09-04T19:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 31.59,
           "conditionCode" => "MostlyClear",
           "forecastStart" => "2023-09-04T20:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 31.94,
           "conditionCode" => "MostlyClear",
           "forecastStart" => "2023-09-04T21:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 31.65,
           "conditionCode" => "MostlyClear",
           "forecastStart" => "2023-09-04T22:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 31.14,
           "conditionCode" => "MostlyClear",
           "forecastStart" => "2023-09-04T23:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 30.3,
           "conditionCode" => "MostlyClear",
           "forecastStart" => "2023-09-05T00:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 28.87,
           "conditionCode" => "MostlyClear",
           "forecastStart" => "2023-09-05T01:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 26.78,
           "conditionCode" => "MostlyClear",
           "forecastStart" => "2023-09-05T02:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 24.96,
           "conditionCode" => "MostlyClear",
           "forecastStart" => "2023-09-05T03:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 23.42,
           "conditionCode" => "MostlyClear",
           "forecastStart" => "2023-09-05T04:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 22.06,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-09-05T05:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 20.88,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-09-05T06:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 19.58,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-09-05T07:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 18.4,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-09-05T08:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 17.3,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-09-05T09:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 16.28,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-09-05T10:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 15.54,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-09-05T11:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 15.79,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-09-05T12:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 17.06,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-09-05T13:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 19.12,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-09-05T14:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 21.48,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-09-05T15:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 24.06,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-09-05T16:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 26.58,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-09-05T17:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 28.38,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-09-05T18:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 29.61,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-09-05T19:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 30.51,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-09-05T20:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 31.02,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-09-05T21:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 30.69,
           "conditionCode" => "MostlyClear",
           "forecastStart" => "2023-09-05T22:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 30.01,
           "conditionCode" => "PartlyCloudy",
           "forecastStart" => "2023-09-05T23:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 29.13,
           "conditionCode" => "PartlyCloudy",
           "forecastStart" => "2023-09-06T00:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 27.94,
           "conditionCode" => "PartlyCloudy",
           "forecastStart" => "2023-09-06T01:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 26.24,
           "conditionCode" => "MostlyClear",
           "forecastStart" => "2023-09-06T02:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 24.71,
           "conditionCode" => "MostlyClear",
           "forecastStart" => "2023-09-06T03:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 23.3,
           "conditionCode" => "MostlyClear",
           "forecastStart" => "2023-09-06T04:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 22.02,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-09-06T05:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 20.91,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-09-06T06:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 19.92,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-09-06T07:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 18.83,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-09-06T08:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 18.02,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-09-06T09:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 17.31,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-09-06T10:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 16.65,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-09-06T11:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 16.05,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-09-06T12:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 20.83,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-09-06T13:00:00Z",
           "precipitationType" => "clear"}]
      }
    }

    WeatherKitAccount.stub :weather, weather do
      travel_to DateTime.new(2023, 8, 27, 16, 20, 0, "-0600") do
        assert_equal(16, WeatherKitAccount.hourly_calendar_events.length)
      end
    end
  end

  def test_wind_hourly_calendar_event
    weather = {
      "forecastHourly" => {
        "hours" => [
          {"temperature" => 20.83,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-08-27T18:00:00Z",
           "precipitationType" => "clear",
           "windGust"=>51.15,}]
      }
    }

    WeatherKitAccount.stub :weather, weather do
      travel_to DateTime.new(2023, 8, 27, 16, 20, 0, "-0600") do
        assert(WeatherKitAccount.hourly_calendar_events.last.summary.include?("32mph"))
      end
    end
  end

  def test_precip_calendar_events_no_data
    WeatherKitAccount.stub :weather, {} do
      assert_equal([], WeatherKitAccount.precip_calendar_events)
    end
  end

  def test_precip_calendar_events_example
    weather = {
      "forecastHourly" => {
        "hours" => [{"temperature" => 18.81,
                     "conditionCode" => "Snow",
                     "forecastStart" => "2023-08-27T05:00:00Z",
                     "precipitationType" => "snow"},
          {"temperature" => 18.11,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-08-27T06:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 17.66,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-08-27T07:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 16.81,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-08-27T08:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 16.11,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-08-27T09:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 15.5,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-08-27T10:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 14.99,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-08-27T11:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 14.32,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-08-27T12:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 15.35,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-08-27T13:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 17.41,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-08-27T14:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 19.69,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-08-27T15:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 22.68,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-08-27T16:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 25.12,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-08-27T17:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 27.37,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-08-27T18:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 29.13,
           "conditionCode" => "MostlyClear",
           "forecastStart" => "2023-08-27T19:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 30.08,
           "conditionCode" => "MostlyClear",
           "forecastStart" => "2023-08-27T20:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 29.73,
           "conditionCode" => "PartlyCloudy",
           "forecastStart" => "2023-08-27T21:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 28.31,
           "conditionCode" => "PartlyCloudy",
           "forecastStart" => "2023-08-27T22:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 27.6,
           "conditionCode" => "MostlyCloudy",
           "forecastStart" => "2023-08-27T23:00:00Z",
           "precipitationType" => "rain",
           "precipitationIntensity" => 0.6},
          {"temperature" => 25.65,
           "conditionCode" => "MostlyCloudy",
           "forecastStart" => "2023-08-28T00:00:00Z",
           "precipitationType" => "rain",
           "precipitationIntensity" => 1.0},
          {"temperature" => 23.74,
           "conditionCode" => "PartlyCloudy",
           "forecastStart" => "2023-08-28T01:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 22.43,
           "conditionCode" => "MostlyCloudy",
           "forecastStart" => "2023-08-28T02:00:00Z",
           "precipitationType" => "rain",
           "precipitationIntensity" => 0.3},
          {"temperature" => 20.73,
           "conditionCode" => "MostlyCloudy",
           "forecastStart" => "2023-08-28T03:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 20.26,
           "conditionCode" => "MostlyCloudy",
           "forecastStart" => "2023-08-28T04:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 19.5,
           "conditionCode" => "MostlyCloudy",
           "forecastStart" => "2023-08-28T05:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 18.91,
           "conditionCode" => "PartlyCloudy",
           "forecastStart" => "2023-08-28T06:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 18.13,
           "conditionCode" => "PartlyCloudy",
           "forecastStart" => "2023-08-28T07:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 16.87,
           "conditionCode" => "MostlyClear",
           "forecastStart" => "2023-08-28T08:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 16.27,
           "conditionCode" => "MostlyClear",
           "forecastStart" => "2023-08-28T09:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 15.74,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-08-28T10:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 15.39,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-08-28T11:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 15.1,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-08-28T12:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 15.47,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-08-28T13:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 16.91,
           "conditionCode" => "MostlyClear",
           "forecastStart" => "2023-08-28T14:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 18.92,
           "conditionCode" => "MostlyClear",
           "forecastStart" => "2023-08-28T15:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 20.22,
           "conditionCode" => "PartlyCloudy",
           "forecastStart" => "2023-08-28T16:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 21.92,
           "conditionCode" => "PartlyCloudy",
           "forecastStart" => "2023-08-28T17:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 23.64,
           "conditionCode" => "MostlyClear",
           "forecastStart" => "2023-08-28T18:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 25.04,
           "conditionCode" => "PartlyCloudy",
           "forecastStart" => "2023-08-28T19:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 24.65,
           "conditionCode" => "MostlyCloudy",
           "forecastStart" => "2023-08-28T20:00:00Z",
           "precipitationType" => "rain",
           "precipitationIntensity" => 0.3},
          {"temperature" => 23.98,
           "conditionCode" => "Drizzle",
           "forecastStart" => "2023-08-28T21:00:00Z",
           "precipitationType" => "rain",
           "precipitationIntensity" => 0.4},
          {"temperature" => 24.0,
           "conditionCode" => "Drizzle",
           "forecastStart" => "2023-08-28T22:00:00Z",
           "precipitationType" => "rain",
           "precipitationIntensity" => 1.0},
          {"temperature" => 22.74,
           "conditionCode" => "Drizzle",
           "forecastStart" => "2023-08-28T23:00:00Z",
           "precipitationType" => "rain",
           "precipitationIntensity" => 1.5},
          {"temperature" => 21.85,
           "conditionCode" => "Drizzle",
           "forecastStart" => "2023-08-29T00:00:00Z",
           "precipitationType" => "rain",
           "precipitationIntensity" => 1.1},
          {"temperature" => 21.21,
           "conditionCode" => "PartlyCloudy",
           "forecastStart" => "2023-08-29T01:00:00Z",
           "precipitationType" => "rain",
           "precipitationIntensity" => 0.3},
          {"temperature" => 20.22,
           "conditionCode" => "MostlyCloudy",
           "forecastStart" => "2023-08-29T02:00:00Z",
           "precipitationType" => "rain",
           "precipitationIntensity" => 0.3},
          {"temperature" => 19.14,
           "conditionCode" => "MostlyClear",
           "forecastStart" => "2023-08-29T03:00:00Z",
           "precipitationType" => "rain",
           "precipitationIntensity" => 0.3},
          {"temperature" => 18.33,
           "conditionCode" => "MostlyClear",
           "forecastStart" => "2023-08-29T04:00:00Z",
           "precipitationType" => "rain",
           "precipitationIntensity" => 0.4},
          {"temperature" => 17.55,
           "conditionCode" => "MostlyClear",
           "forecastStart" => "2023-08-29T05:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 17.03,
           "conditionCode" => "MostlyClear",
           "forecastStart" => "2023-08-29T06:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 16.45,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-08-29T07:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 15.66,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-08-29T08:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 15.05,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-08-29T09:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 14.44,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-08-29T10:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 13.91,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-08-29T11:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 13.53,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-08-29T12:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 14.1,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-08-29T13:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 15.68,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-08-29T14:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 17.89,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-08-29T15:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 20.06,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-08-29T16:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 22.03,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-08-29T17:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 23.72,
           "conditionCode" => "MostlyClear",
           "forecastStart" => "2023-08-29T18:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 25.42,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-08-29T19:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 26.7,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-08-29T20:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 27.66,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-08-29T21:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 28.27,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-08-29T22:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 28.45,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-08-29T23:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 27.79,
           "conditionCode" => "MostlyClear",
           "forecastStart" => "2023-08-30T00:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 26.46,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-08-30T01:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 24.31,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-08-30T02:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 22.81,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-08-30T03:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 21.4,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-08-30T04:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 20.19,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-08-30T05:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 19.23,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-08-30T06:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 18.4,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-08-30T07:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 17.41,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-08-30T08:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 16.71,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-08-30T09:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 15.8,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-08-30T10:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 14.99,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-08-30T11:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 14.2,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-08-30T12:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 14.95,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-08-30T13:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 16.81,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-08-30T14:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 19.98,
           "conditionCode" => "MostlyClear",
           "forecastStart" => "2023-08-30T15:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 23.32,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-08-30T16:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 26.88,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-08-30T17:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 29.81,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-08-30T18:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 31.97,
           "conditionCode" => "MostlyClear",
           "forecastStart" => "2023-08-30T19:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 33.4,
           "conditionCode" => "MostlyClear",
           "forecastStart" => "2023-08-30T20:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 34.28,
           "conditionCode" => "MostlyClear",
           "forecastStart" => "2023-08-30T21:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 34.65,
           "conditionCode" => "MostlyClear",
           "forecastStart" => "2023-08-30T22:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 34.21,
           "conditionCode" => "MostlyClear",
           "forecastStart" => "2023-08-30T23:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 32.83,
           "conditionCode" => "MostlyClear",
           "forecastStart" => "2023-08-31T00:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 30.81,
           "conditionCode" => "MostlyClear",
           "forecastStart" => "2023-08-31T01:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 28.22,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-08-31T02:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 25.95,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-08-31T03:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 24.23,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-08-31T04:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 22.8,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-08-31T05:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 21.77,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-08-31T06:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 20.6,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-08-31T07:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 19.53,
           "conditionCode" => "MostlyClear",
           "forecastStart" => "2023-08-31T08:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 18.67,
           "conditionCode" => "MostlyClear",
           "forecastStart" => "2023-08-31T09:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 17.68,
           "conditionCode" => "MostlyClear",
           "forecastStart" => "2023-08-31T10:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 16.75,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-08-31T11:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 16.51,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-08-31T12:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 17.72,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-08-31T13:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 19.71,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-08-31T14:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 22.07,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-08-31T15:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 24.83,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-08-31T16:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 28.03,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-08-31T17:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 30.93,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-08-31T18:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 32.56,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-08-31T19:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 33.72,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-08-31T20:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 34.45,
           "conditionCode" => "MostlyClear",
           "forecastStart" => "2023-08-31T21:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 34.79,
           "conditionCode" => "MostlyClear",
           "forecastStart" => "2023-08-31T22:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 34.24,
           "conditionCode" => "MostlyClear",
           "forecastStart" => "2023-08-31T23:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 32.9,
           "conditionCode" => "MostlyClear",
           "forecastStart" => "2023-09-01T00:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 30.49,
           "conditionCode" => "MostlyClear",
           "forecastStart" => "2023-09-01T01:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 27.59,
           "conditionCode" => "MostlyClear",
           "forecastStart" => "2023-09-01T02:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 25.02,
           "conditionCode" => "MostlyClear",
           "forecastStart" => "2023-09-01T03:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 23.45,
           "conditionCode" => "MostlyClear",
           "forecastStart" => "2023-09-01T04:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 22.17,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-09-01T05:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 20.81,
           "conditionCode" => "MostlyClear",
           "forecastStart" => "2023-09-01T06:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 19.55,
           "conditionCode" => "MostlyClear",
           "forecastStart" => "2023-09-01T07:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 18.61,
           "conditionCode" => "MostlyClear",
           "forecastStart" => "2023-09-01T08:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 18.1,
           "conditionCode" => "MostlyClear",
           "forecastStart" => "2023-09-01T09:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 17.39,
           "conditionCode" => "PartlyCloudy",
           "forecastStart" => "2023-09-01T10:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 16.55,
           "conditionCode" => "MostlyCloudy",
           "forecastStart" => "2023-09-01T11:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 17.22,
           "conditionCode" => "MostlyCloudy",
           "forecastStart" => "2023-09-01T12:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 18.33,
           "conditionCode" => "MostlyCloudy",
           "forecastStart" => "2023-09-01T13:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 19.72,
           "conditionCode" => "PartlyCloudy",
           "forecastStart" => "2023-09-01T14:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 21.72,
           "conditionCode" => "PartlyCloudy",
           "forecastStart" => "2023-09-01T15:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 24.99,
           "conditionCode" => "PartlyCloudy",
           "forecastStart" => "2023-09-01T16:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 27.91,
           "conditionCode" => "PartlyCloudy",
           "forecastStart" => "2023-09-01T17:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 30.2,
           "conditionCode" => "PartlyCloudy",
           "forecastStart" => "2023-09-01T18:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 31.57,
           "conditionCode" => "PartlyCloudy",
           "forecastStart" => "2023-09-01T19:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 32.34,
           "conditionCode" => "MostlyCloudy",
           "forecastStart" => "2023-09-01T20:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 31.9,
           "conditionCode" => "MostlyCloudy",
           "forecastStart" => "2023-09-01T21:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 30.13,
           "conditionCode" => "MostlyCloudy",
           "forecastStart" => "2023-09-01T22:00:00Z",
           "precipitationType" => "rain",
           "precipitationIntensity" => 0.2},
          {"temperature" => 27.87,
           "conditionCode" => "Cloudy",
           "forecastStart" => "2023-09-01T23:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 26.44,
           "conditionCode" => "Cloudy",
           "forecastStart" => "2023-09-02T00:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 24.68,
           "conditionCode" => "Cloudy",
           "forecastStart" => "2023-09-02T01:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 23.34,
           "conditionCode" => "MostlyCloudy",
           "forecastStart" => "2023-09-02T02:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 22.21,
           "conditionCode" => "MostlyCloudy",
           "forecastStart" => "2023-09-02T03:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 21.38,
           "conditionCode" => "MostlyCloudy",
           "forecastStart" => "2023-09-02T04:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 20.4,
           "conditionCode" => "MostlyCloudy",
           "forecastStart" => "2023-09-02T05:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 19.74,
           "conditionCode" => "PartlyCloudy",
           "forecastStart" => "2023-09-02T06:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 18.91,
           "conditionCode" => "PartlyCloudy",
           "forecastStart" => "2023-09-02T07:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 18.6,
           "conditionCode" => "PartlyCloudy",
           "forecastStart" => "2023-09-02T08:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 17.98,
           "conditionCode" => "PartlyCloudy",
           "forecastStart" => "2023-09-02T09:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 17.32,
           "conditionCode" => "PartlyCloudy",
           "forecastStart" => "2023-09-02T10:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 16.73,
           "conditionCode" => "PartlyCloudy",
           "forecastStart" => "2023-09-02T11:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 17.06,
           "conditionCode" => "PartlyCloudy",
           "forecastStart" => "2023-09-02T12:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 18.27,
           "conditionCode" => "PartlyCloudy",
           "forecastStart" => "2023-09-02T13:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 20.07,
           "conditionCode" => "PartlyCloudy",
           "forecastStart" => "2023-09-02T14:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 22.12,
           "conditionCode" => "PartlyCloudy",
           "forecastStart" => "2023-09-02T15:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 24.49,
           "conditionCode" => "PartlyCloudy",
           "forecastStart" => "2023-09-02T16:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 26.88,
           "conditionCode" => "PartlyCloudy",
           "forecastStart" => "2023-09-02T17:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 28.67,
           "conditionCode" => "PartlyCloudy",
           "forecastStart" => "2023-09-02T18:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 29.9,
           "conditionCode" => "PartlyCloudy",
           "forecastStart" => "2023-09-02T19:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 30.78,
           "conditionCode" => "PartlyCloudy",
           "forecastStart" => "2023-09-02T20:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 31.17,
           "conditionCode" => "PartlyCloudy",
           "forecastStart" => "2023-09-02T21:00:00Z",
           "precipitationType" => "rain",
           "precipitationIntensity" => 0.3},
          {"temperature" => 30.28,
           "conditionCode" => "PartlyCloudy",
           "forecastStart" => "2023-09-02T22:00:00Z",
           "precipitationType" => "rain",
           "precipitationIntensity" => 0.3},
          {"temperature" => 28.95,
           "conditionCode" => "MostlyCloudy",
           "forecastStart" => "2023-09-02T23:00:00Z",
           "precipitationType" => "rain",
           "precipitationIntensity" => 0.3},
          {"temperature" => 27.66,
           "conditionCode" => "Cloudy",
           "forecastStart" => "2023-09-03T00:00:00Z",
           "precipitationType" => "rain",
           "precipitationIntensity" => 0.3},
          {"temperature" => 26.92,
           "conditionCode" => "MostlyCloudy",
           "forecastStart" => "2023-09-03T01:00:00Z",
           "precipitationType" => "rain",
           "precipitationIntensity" => 0.3},
          {"temperature" => 25.27,
           "conditionCode" => "MostlyCloudy",
           "forecastStart" => "2023-09-03T02:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 23.97,
           "conditionCode" => "PartlyCloudy",
           "forecastStart" => "2023-09-03T03:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 22.8,
           "conditionCode" => "PartlyCloudy",
           "forecastStart" => "2023-09-03T04:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 21.46,
           "conditionCode" => "MostlyClear",
           "forecastStart" => "2023-09-03T05:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 20.53,
           "conditionCode" => "MostlyClear",
           "forecastStart" => "2023-09-03T06:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 19.53,
           "conditionCode" => "MostlyClear",
           "forecastStart" => "2023-09-03T07:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 18.72,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-09-03T08:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 17.94,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-09-03T09:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 17.09,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-09-03T10:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 16.32,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-09-03T11:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 16.67,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-09-03T12:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 16.85,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-09-03T13:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 19.05,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-09-03T14:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 21.47,
           "conditionCode" => "MostlyClear",
           "forecastStart" => "2023-09-03T15:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 24.09,
           "conditionCode" => "MostlyClear",
           "forecastStart" => "2023-09-03T16:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 26.69,
           "conditionCode" => "MostlyClear",
           "forecastStart" => "2023-09-03T17:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 28.56,
           "conditionCode" => "MostlyClear",
           "forecastStart" => "2023-09-03T18:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 29.73,
           "conditionCode" => "MostlyClear",
           "forecastStart" => "2023-09-03T19:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 30.48,
           "conditionCode" => "MostlyClear",
           "forecastStart" => "2023-09-03T20:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 30.85,
           "conditionCode" => "MostlyClear",
           "forecastStart" => "2023-09-03T21:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 30.4,
           "conditionCode" => "MostlyClear",
           "forecastStart" => "2023-09-03T22:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 29.59,
           "conditionCode" => "PartlyCloudy",
           "forecastStart" => "2023-09-03T23:00:00Z",
           "precipitationType" => "rain",
           "precipitationIntensity" => 0.2},
          {"temperature" => 28.68,
           "conditionCode" => "PartlyCloudy",
           "forecastStart" => "2023-09-04T00:00:00Z",
           "precipitationType" => "rain",
           "precipitationIntensity" => 0.3},
          {"temperature" => 27.79,
           "conditionCode" => "PartlyCloudy",
           "forecastStart" => "2023-09-04T01:00:00Z",
           "precipitationType" => "rain",
           "precipitationIntensity" => 0.2},
          {"temperature" => 25.83,
           "conditionCode" => "PartlyCloudy",
           "forecastStart" => "2023-09-04T02:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 24.09,
           "conditionCode" => "PartlyCloudy",
           "forecastStart" => "2023-09-04T03:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 22.53,
           "conditionCode" => "PartlyCloudy",
           "forecastStart" => "2023-09-04T04:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 21.16,
           "conditionCode" => "PartlyCloudy",
           "forecastStart" => "2023-09-04T05:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 20.04,
           "conditionCode" => "PartlyCloudy",
           "forecastStart" => "2023-09-04T06:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 18.88,
           "conditionCode" => "MostlyClear",
           "forecastStart" => "2023-09-04T07:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 17.9,
           "conditionCode" => "MostlyClear",
           "forecastStart" => "2023-09-04T08:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 17.0,
           "conditionCode" => "MostlyClear",
           "forecastStart" => "2023-09-04T09:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 16.15,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-09-04T10:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 15.56,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-09-04T11:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 15.99,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-09-04T12:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 17.47,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-09-04T13:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 19.78,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-09-04T14:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 22.39,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-09-04T15:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 25.2,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-09-04T16:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 27.92,
           "conditionCode" => "MostlyClear",
           "forecastStart" => "2023-09-04T17:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 29.8,
           "conditionCode" => "MostlyClear",
           "forecastStart" => "2023-09-04T18:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 30.92,
           "conditionCode" => "MostlyClear",
           "forecastStart" => "2023-09-04T19:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 31.59,
           "conditionCode" => "MostlyClear",
           "forecastStart" => "2023-09-04T20:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 31.94,
           "conditionCode" => "MostlyClear",
           "forecastStart" => "2023-09-04T21:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 31.65,
           "conditionCode" => "MostlyClear",
           "forecastStart" => "2023-09-04T22:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 31.14,
           "conditionCode" => "MostlyClear",
           "forecastStart" => "2023-09-04T23:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 30.3,
           "conditionCode" => "MostlyClear",
           "forecastStart" => "2023-09-05T00:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 28.87,
           "conditionCode" => "MostlyClear",
           "forecastStart" => "2023-09-05T01:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 26.78,
           "conditionCode" => "MostlyClear",
           "forecastStart" => "2023-09-05T02:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 24.96,
           "conditionCode" => "MostlyClear",
           "forecastStart" => "2023-09-05T03:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 23.42,
           "conditionCode" => "MostlyClear",
           "forecastStart" => "2023-09-05T04:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 22.06,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-09-05T05:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 20.88,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-09-05T06:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 19.58,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-09-05T07:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 18.4,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-09-05T08:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 17.3,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-09-05T09:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 16.28,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-09-05T10:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 15.54,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-09-05T11:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 15.79,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-09-05T12:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 17.06,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-09-05T13:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 19.12,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-09-05T14:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 21.48,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-09-05T15:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 24.06,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-09-05T16:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 26.58,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-09-05T17:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 28.38,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-09-05T18:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 29.61,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-09-05T19:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 30.51,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-09-05T20:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 31.02,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-09-05T21:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 30.69,
           "conditionCode" => "MostlyClear",
           "forecastStart" => "2023-09-05T22:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 30.01,
           "conditionCode" => "PartlyCloudy",
           "forecastStart" => "2023-09-05T23:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 29.13,
           "conditionCode" => "PartlyCloudy",
           "forecastStart" => "2023-09-06T00:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 27.94,
           "conditionCode" => "PartlyCloudy",
           "forecastStart" => "2023-09-06T01:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 26.24,
           "conditionCode" => "MostlyClear",
           "forecastStart" => "2023-09-06T02:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 24.71,
           "conditionCode" => "MostlyClear",
           "forecastStart" => "2023-09-06T03:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 23.3,
           "conditionCode" => "MostlyClear",
           "forecastStart" => "2023-09-06T04:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 22.02,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-09-06T05:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 20.91,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-09-06T06:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 19.92,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-09-06T07:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 18.83,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-09-06T08:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 18.02,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-09-06T09:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 17.31,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-09-06T10:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 16.65,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-09-06T11:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 16.05,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-09-06T12:00:00Z",
           "precipitationType" => "clear"},
          {"temperature" => 20.83,
           "conditionCode" => "Clear",
           "forecastStart" => "2023-09-06T13:00:00Z",
           "precipitationType" => "clear"}]
      }
    }

    WeatherKitAccount.stub :weather, weather do
      travel_to DateTime.new(2023, 8, 27, 16, 20, 0, "-0600") do
        assert_equal(7, WeatherKitAccount.precip_calendar_events.length)
      end
    end
  end

  def test_fetch_raises_no_errors
    VCR.use_cassette("weatherkit_fetch") do
      WeatherKitAccount.fetch
    end
  end

  def test_daily_calendar_events
    weather = {
      "forecastDaily" => {"days" =>
        [{"sunset" => "2023-09-16T01:09:01Z",
          "sunrise" => "2023-09-15T12:41:05Z",
          "moonrise" => "2023-09-15T13:08:37Z",
          "forecastEnd" => "2023-09-16T06:00:00Z",
          "conditionCode" => "Missing",
          "forecastStart" => "2023-09-15T06:00:00Z",
          "snowfallAmount" => 0.0,
          "temperatureMax" => 18.86,
          "temperatureMin" => 11.1,
          "precipitationType" => "clear",
          "precipitationAmount" => 0.2,
          "precipitationChance" => 0.0,
          "sunriseAstronomical" => "2023-09-15T11:09:07Z",
          "precipitationAmountByType" => {}},
          {"sunset" => "2023-09-17T01:07:22Z",
           "sunrise" => "2023-09-16T12:42:01Z",
           "moonrise" => "2023-09-16T14:08:46Z",
           "forecastEnd" => "2023-09-17T06:00:00Z",
           "conditionCode" => "Clear",
           "forecastStart" => "2023-09-16T06:00:00Z",
           "snowfallAmount" => 0.0,
           "temperatureMax" => 24.23,
           "temperatureMin" => 8.49,
           "precipitationType" => "clear",
           "sunsetAstronomical" => "2023-09-17T02:38:56Z",
           "precipitationAmount" => 0.0,
           "precipitationChance" => 0.0,
           "sunriseAstronomical" => "2023-09-16T11:10:15Z",
           "precipitationAmountByType" => {}},
          {"sunset" => "2023-09-18T01:05:42Z",
           "sunrise" => "2023-09-17T12:42:57Z",
           "moonrise" => "2023-09-17T15:10:06Z",
           "forecastEnd" => "2023-09-18T06:00:00Z",
           "conditionCode" => "MostlyClear",
           "forecastStart" => "2023-09-17T06:00:00Z",
           "snowfallAmount" => 0.0,
           "temperatureMax" => 28.16,
           "temperatureMin" => 10.03,
           "precipitationType" => "clear",
           "sunsetAstronomical" => "2023-09-18T02:37:07Z",
           "precipitationAmount" => 0.0,
           "precipitationChance" => 0.0,
           "sunriseAstronomical" => "2023-09-17T11:11:22Z",
           "precipitationAmountByType" => {}},
          {"sunset" => "2023-09-19T01:04:02Z",
           "sunrise" => "2023-09-18T12:43:54Z",
           "moonrise" => "2023-09-18T16:13:33Z",
           "forecastEnd" => "2023-09-19T06:00:00Z",
           "conditionCode" => "PartlyCloudy",
           "forecastStart" => "2023-09-18T06:00:00Z",
           "snowfallAmount" => 0.0,
           "temperatureMax" => 28.6,
           "temperatureMin" => 13.7,
           "precipitationType" => "clear",
           "sunsetAstronomical" => "2023-09-19T02:35:18Z",
           "precipitationAmount" => 0.0,
           "precipitationChance" => 0.0,
           "sunriseAstronomical" => "2023-09-18T11:12:29Z",
           "precipitationAmountByType" => {}},
          {"sunset" => "2023-09-20T01:02:23Z",
           "sunrise" => "2023-09-19T12:44:50Z",
           "moonrise" => "2023-09-19T17:19:38Z",
           "forecastEnd" => "2023-09-20T06:00:00Z",
           "conditionCode" => "PartlyCloudy",
           "forecastStart" => "2023-09-19T06:00:00Z",
           "snowfallAmount" => 0.0,
           "temperatureMax" => 26.74,
           "temperatureMin" => 13.54,
           "precipitationType" => "clear",
           "sunsetAstronomical" => "2023-09-20T02:33:30Z",
           "precipitationAmount" => 0.0,
           "precipitationChance" => 0.0,
           "sunriseAstronomical" => "2023-09-19T11:13:35Z",
           "precipitationAmountByType" => {}},
          {"sunset" => "2023-09-21T01:00:43Z",
           "sunrise" => "2023-09-20T12:45:46Z",
           "moonrise" => "2023-09-20T18:28:01Z",
           "forecastEnd" => "2023-09-21T06:00:00Z",
           "conditionCode" => "PartlyCloudy",
           "forecastStart" => "2023-09-20T06:00:00Z",
           "snowfallAmount" => 0.0,
           "temperatureMax" => 27.22,
           "temperatureMin" => 11.76,
           "precipitationType" => "clear",
           "sunsetAstronomical" => "2023-09-21T02:31:42Z",
           "precipitationAmount" => 0.0,
           "precipitationChance" => 0.0,
           "sunriseAstronomical" => "2023-09-20T11:14:41Z",
           "precipitationAmountByType" => {}},
          {"sunset" => "2023-09-22T00:59:04Z",
           "sunrise" => "2023-09-21T12:46:43Z",
           "moonrise" => "2023-09-21T19:36:52Z",
           "forecastEnd" => "2023-09-22T06:00:00Z",
           "conditionCode" => "MostlyClear",
           "forecastStart" => "2023-09-21T06:00:00Z",
           "snowfallAmount" => 0.0,
           "temperatureMax" => 27.29,
           "temperatureMin" => 11.82,
           "precipitationType" => "clear",
           "sunsetAstronomical" => "2023-09-22T02:29:54Z",
           "precipitationAmount" => 0.0,
           "precipitationChance" => 0.0,
           "sunriseAstronomical" => "2023-09-21T11:15:46Z",
           "precipitationAmountByType" => {}},
          {"sunset" => "2023-09-23T00:57:26Z",
           "sunrise" => "2023-09-22T12:47:40Z",
           "moonrise" => "2023-09-22T20:42:47Z",
           "forecastEnd" => "2023-09-23T06:00:00Z",
           "conditionCode" => "MostlyClear",
           "forecastStart" => "2023-09-22T06:00:00Z",
           "snowfallAmount" => 0.0,
           "temperatureMax" => 24.36,
           "temperatureMin" => 11.23,
           "precipitationType" => "rain",
           "sunsetAstronomical" => "2023-09-23T02:28:07Z",
           "precipitationAmount" => 0.5,
           "precipitationChance" => 0.13,
           "sunriseAstronomical" => "2023-09-22T11:16:52Z",
           "precipitationAmountByType" => {}},
          {"sunset" => "2023-09-24T00:55:47Z",
           "sunrise" => "2023-09-23T12:48:36Z",
           "moonrise" => "2023-09-23T21:41:52Z",
           "forecastEnd" => "2023-09-24T06:00:00Z",
           "conditionCode" => "MostlyClear",
           "forecastStart" => "2023-09-23T06:00:00Z",
           "snowfallAmount" => 0.0,
           "temperatureMax" => 21.08,
           "temperatureMin" => 10.76,
           "precipitationType" => "rain",
           "sunsetAstronomical" => "2023-09-24T02:26:21Z",
           "precipitationAmount" => 0.5,
           "precipitationChance" => 0.35,
           "sunriseAstronomical" => "2023-09-23T11:17:56Z",
           "precipitationAmountByType" => {}},
          {"sunset" => "2023-09-25T00:54:09Z",
           "sunrise" => "2023-09-24T12:49:33Z",
           "moonrise" => "2023-09-24T22:31:46Z",
           "forecastEnd" => "2023-09-25T06:00:00Z",
           "conditionCode" => "MostlyClear",
           "forecastStart" => "2023-09-24T06:00:00Z",
           "snowfallAmount" => 0.0,
           "temperatureMax" => 21.58,
           "temperatureMin" => 8.74,
           "precipitationType" => "clear",
           "sunsetAstronomical" => "2023-09-25T02:24:35Z",
           "precipitationAmount" => 0.0,
           "precipitationChance" => 0.0,
           "sunriseAstronomical" => "2023-09-24T11:19:01Z",
           "precipitationAmountByType" => {}}],
                          "name" => "DailyForecast",
                          "metadata" =>
        {"units" => "m",
         "version" => 1,
         "latitude" => 39.915,
         "readTime" => "2023-09-15T15:44:28Z",
         "longitude" => -105.022,
         "expireTime" => "2023-09-15T16:44:28Z",
         "reportedTime" => "2023-09-15T15:00:00Z",
         "attributionURL" =>
          "https://developer.apple.com/weatherkit/data-source-attribution/"}}
    }

    WeatherKitAccount.stub :weather, weather do
      assert_equal(10, WeatherKitAccount.daily_calendar_events.length)
    end
  end

  def test_daily_calendar_events_snow_precip
    weather = {
      "forecastDaily" => {"days" =>
        [{"forecastStart" => "2024-01-15T07:00:00Z",
          "forecastEnd" => "2024-01-16T07:00:00Z",
          "conditionCode" => "Snow",
          "maxUvIndex" => 1,
          "moonPhase" => "waxingCrescent",
          "moonrise" => "2024-01-15T17:16:34Z",
          "moonset" => "2024-01-16T05:17:41Z",
          "precipitationAmount" => 2.05,
          "precipitationChance" => 0.35,
          "precipitationType" => "snow",
          "snowfallAmount" => 70.09,
          "solarMidnight" => "2024-01-15T07:09:14Z",
          "solarNoon" => "2024-01-15T19:09:36Z",
          "sunrise" => "2024-01-15T14:20:01Z",
          "sunriseCivil" => "2024-01-15T13:50:20Z",
          "sunriseNautical" => "2024-01-15T13:17:00Z",
          "sunriseAstronomical" => "2024-01-15T12:44:34Z",
          "sunset" => "2024-01-15T23:59:18Z",
          "sunsetCivil" => "2024-01-16T00:29:04Z",
          "sunsetNautical" => "2024-01-16T01:02:18Z",
          "sunsetAstronomical" => "2024-01-16T01:34:50Z",
          "temperatureMax" => -16.58,
          "temperatureMin" => -24.15,
          "daytimeForecast" =>
         {"forecastStart" => "2024-01-15T14:00:00Z",
          "forecastEnd" => "2024-01-16T02:00:00Z",
          "cloudCover" => 0.8,
          "conditionCode" => "Snow",
          "humidity" => 0.81,
          "precipitationAmount" => 2.05,
          "precipitationChance" => 0.34,
          "precipitationType" => "snow",
          "snowfallAmount" => 70.09,
          "temperatureMax" => -16.58,
          "temperatureMin" => -23.15,
          "windDirection" => 351,
          "windSpeed" => 11.08},
          "overnightForecast" =>
         {"forecastStart" => "2024-01-16T02:00:00Z",
          "forecastEnd" => "2024-01-16T14:00:00Z",
          "cloudCover" => 0.11,
          "conditionCode" => "Clear",
          "humidity" => 0.7,
          "precipitationAmount" => 0.0,
          "precipitationChance" => 0.0,
          "precipitationType" => "clear",
          "snowfallAmount" => 0.0,
          "temperatureMax" => -19.56,
          "temperatureMin" => -24.15,
          "windDirection" => 217,
          "windSpeed" => 7.94}}],
                          "name" => "DailyForecast",
                          "metadata" =>
        {"units" => "m",
         "version" => 1,
         "latitude" => 39.915,
         "readTime" => "2023-09-15T15:44:28Z",
         "longitude" => -105.022,
         "expireTime" => "2023-09-15T16:44:28Z",
         "reportedTime" => "2023-09-15T15:00:00Z",
         "attributionURL" =>
          "https://developer.apple.com/weatherkit/data-source-attribution/"}}
    }

    WeatherKitAccount.stub :weather, weather do
      assert(WeatherKitAccount.daily_calendar_events.first.summary.include?('2.8"'))
    end
  end

  def test_daily_calendar_events_rain_precip
    weather = {
      "forecastDaily" => {"days" =>
        [{"forecastStart"=>"2024-04-26T06:00:00Z",
        "forecastEnd"=>"2024-04-27T06:00:00Z",
        "conditionCode"=>"Rain",
        "maxUvIndex"=>6,
        "moonPhase"=>"waningGibbous",
        "moonrise"=>"2024-04-27T05:09:51Z",
        "moonset"=>"2024-04-26T13:20:07Z",
        "precipitationAmount"=>7.82,
        "precipitationChance"=>0.96,
        "precipitationType"=>"rain",
        "snowfallAmount"=>0.0,
        "solarMidnight"=>"2024-04-26T06:57:40Z",
        "solarNoon"=>"2024-04-26T18:57:55Z",
        "sunrise"=>"2024-04-26T12:05:57Z",
        "sunriseCivil"=>"2024-04-26T11:37:15Z",
        "sunriseNautical"=>"2024-04-26T11:02:07Z",
        "sunriseAstronomical"=>"2024-04-26T10:25:01Z",
        "sunset"=>"2024-04-27T01:50:25Z",
        "sunsetCivil"=>"2024-04-27T02:19:25Z",
        "sunsetNautical"=>"2024-04-27T02:54:29Z",
        "sunsetAstronomical"=>"2024-04-27T03:32:13Z",
        "temperatureMax"=>19.92,
        "temperatureMin"=>8.23,
        "windGustSpeedMax"=>26.93,
        "windSpeedAvg"=>8.8,
        "windSpeedMax"=>14.45,
        "daytimeForecast"=>
         {"forecastStart"=>"2024-04-26T13:00:00Z",
          "forecastEnd"=>"2024-04-27T01:00:00Z",
          "cloudCover"=>0.64,
          "conditionCode"=>"MostlyCloudy",
          "humidity"=>0.39,
          "precipitationAmount"=>1.12,
          "precipitationChance"=>0.14,
          "precipitationType"=>"rain",
          "snowfallAmount"=>0.0,
          "temperatureMax"=>19.92,
          "temperatureMin"=>9.67,
          "windDirection"=>20,
          "windGustSpeedMax"=>25.73,
          "windSpeed"=>9.47,
          "windSpeedMax"=>14.45},
        "overnightForecast"=>
         {"forecastStart"=>"2024-04-27T01:00:00Z",
          "forecastEnd"=>"2024-04-27T13:00:00Z",
          "cloudCover"=>0.97,
          "conditionCode"=>"Rain",
          "humidity"=>0.8,
          "precipitationAmount"=>14.75,
          "precipitationChance"=>0.96,
          "precipitationType"=>"rain",
          "snowfallAmount"=>0.0,
          "temperatureMax"=>11.51,
          "temperatureMin"=>5.99,
          "windDirection"=>344,
          "windGustSpeedMax"=>26.93,
          "windSpeed"=>11.57,
          "windSpeedMax"=>13.89},
        "restOfDayForecast"=>
         {"forecastStart"=>"2024-04-27T03:19:06Z",
          "forecastEnd"=>"2024-04-27T06:00:00Z",
          "cloudCover"=>0.97,
          "conditionCode"=>"Rain",
          "humidity"=>0.8,
          "precipitationAmount"=>4.41,
          "precipitationChance"=>0.96,
          "precipitationType"=>"rain",
          "snowfallAmount"=>0.0,
          "temperatureMax"=>9.15,
          "temperatureMin"=>8.23,
          "windDirection"=>345,
          "windGustSpeedMax"=>25.57,
          "windSpeed"=>11.62,
          "windSpeedMax"=>12.64}}],
                          "name" => "DailyForecast",
                          "metadata" =>
        {"units" => "m",
         "version" => 1,
         "latitude" => 39.915,
         "readTime" => "2023-09-15T15:44:28Z",
         "longitude" => -105.022,
         "expireTime" => "2023-09-15T16:44:28Z",
         "reportedTime" => "2023-09-15T15:00:00Z",
         "attributionURL" =>
          "https://developer.apple.com/weatherkit/data-source-attribution/"}}
    }

    WeatherKitAccount.stub :weather, weather do
      assert(WeatherKitAccount.daily_calendar_events.first.summary.include?('0.3"'))
    end
  end

  def test_daily_calendar_events_no_data
    WeatherKitAccount.stub :weather, {} do
      assert_equal([], WeatherKitAccount.daily_calendar_events)
    end
  end

  def test_weather_alert_calendar_events
    WeatherKitAccount.stub :weather, {} do
      assert_equal([], WeatherKitAccount.weather_alert_calendar_events)
    end
  end

  def test_weather_alert_calendar_events_with_data
    weather = {
      "weatherAlerts" => {
        "alerts" => [
          {
            "id" => "8022c653-95e6-5761-876a-62c74c11f720",
            "name" => "WeatherAlertSummary",
            "token" => "WINTER_STORM_WARNING",
            "areaId" => "coz040",
            "source" => "National Weather Service",
            "urgency" => "expected",
            "areaName" => "North Douglas County Below 6000 Feet/Denver/West Adams and Arapahoe Counties/East Broomfield County",
            "severity" => "moderate",
            "certainty" => "likely",
            "responses" => [],
            "detailsUrl" => "https://weatherkit.apple.com/alertDetails/index.html?ids=8022c653-95e6-5761-876a-62c74c11f720&lang=en-US&timezone=America/Denver",
            "expireTime" => "2023-10-29T18:00:00Z",
            "importance" => "normal",
            "issuedTime" => "2023-10-29T01:11:00Z",
            "phenomenon" => "Ice",
            "precedence" => 0,
            "countryCode" => "US",
            "description" => "Winter Storm Warning",
            "eventSource" => "US",
            "eventEndTime" => "2023-10-29T18:00:00Z",
            "significance" => "warning",
            "effectiveTime" => "2023-10-29T01:11:00Z",
            "attributionURL" => "https://alerts.weather.gov/cap/wwacapget.php?x=CO1266674C329C.WinterStormWarning.1266674EC660CO.BOUWSWBOU.9b8acaa8e297b48e73cf808a93a6e421"
          }
        ]
      }
    }

    WeatherKitAccount.stub :weather, weather do
      assert_equal(1, WeatherKitAccount.weather_alert_calendar_events.length)
    end
  end
end
